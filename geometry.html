
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Geometry : mdtraj.geometry &mdash; MDTraj 0.4.1 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.4.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="MDTraj 0.4.1 documentation" href="index.html" />
    <link rel="next" title="MSMBuilder2 Compatibility (.lh5)" href="compatibility.html" />
    <link rel="prev" title="Generic (Compressed) Array IO : mdtraj.io" href="io.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="compatibility.html" title="MSMBuilder2 Compatibility (.lh5)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="io.html" title="Generic (Compressed) Array IO : mdtraj.io"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">MDTraj 0.4.1 documentation</a> |</li>
<a href="getting_started.html">Getting Started</a> |
<a href="https://github.com/rmcgibbo/mdtraj/issues">Bugs</a> |
<a href="examples/index.html">Examples</a> |
<a href="mdconvert.html"><span class="pre">mdconvert</span></a>
 

      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="geometry-mdtraj-geometry">
<h1>Geometry : <tt class="xref py py-class docutils literal"><span class="pre">mdtraj.geometry</span></tt><a class="headerlink" href="#geometry-mdtraj-geometry" title="Permalink to this headline">¶</a></h1>
<p><tt class="xref py py-class docutils literal"><span class="pre">mdtraj.geometry</span></tt> contains functions to extract geometry observables
from molecular dynamics trajectories, including distances, angles,
dihedrals and solvent accessible surface areas. Also included is
code for global structural properties, like the radius of gyration,
3d alignment and rotation. Finally, code for more complex structural analysis,
including the identification of backbone hydrogen bonds based on the Kabsch-Sander
hydrogen bond energy (used by DSSP) is included.</p>
<p>The core geometry code for calculating distances, angles and dihedrals
is written in both SIMD optimized C and standard numpy. The implementations
are tested against each other (as well as external references) and the
fastest platform available on your machine will be used.</p>
<div class="section" id="distances">
<h2>Distances<a class="headerlink" href="#distances" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="mdtraj.geometry.compute_distances">
<tt class="descclassname">mdtraj.geometry.</tt><tt class="descname">compute_distances</tt><big>(</big><em>traj</em>, <em>atom_pairs</em>, <em>periodic=True</em>, <em>opt=True</em><big>)</big><a class="headerlink" href="#mdtraj.geometry.compute_distances" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the distances between pairs of atoms in each frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory</p>
<blockquote>
<div><p>An mtraj trajectory.</p>
</div></blockquote>
<p><strong>atom_pairs</strong> : np.ndarray, shape=(num_pairs, 2), dtype=int</p>
<blockquote>
<div><p>Each row gives the indices of two atoms involved in the interaction.</p>
</div></blockquote>
<p><strong>periodic</strong> : bool, default=True</p>
<blockquote>
<div><p>If <cite>periodic</cite> is True and the trajectory contains unitcell
information, we will compute distances under the minimum image
convention.</p>
</div></blockquote>
<p><strong>opt</strong> : bool, default=True</p>
<blockquote>
<div><p>Use an optimized native library to calculate distances. Using this
library requires the python package &#8220;cffi&#8221; (c foreign function
interface) which is installable via &#8220;easy_install cffi&#8221; or &#8220;pip
install cffi&#8221;. See <a class="reference external" href="https://pypi.python.org/pypi/cffi">https://pypi.python.org/pypi/cffi</a> for more details.
Our optimized minimum image convention calculation implementation is
over 1000x faster than the naive numpy implementation, so installing
cffi is worth it.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>distances</strong> : np.ndarray, shape=(n_frames, num_pairs), dtype=float</p>
<blockquote class="last">
<div><p>The distance, in each frame, between each pair of atoms.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="angles">
<h2>Angles<a class="headerlink" href="#angles" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="mdtraj.geometry.compute_angles">
<tt class="descclassname">mdtraj.geometry.</tt><tt class="descname">compute_angles</tt><big>(</big><em>traj</em>, <em>angle_indices</em>, <em>opt=True</em><big>)</big><a class="headerlink" href="#mdtraj.geometry.compute_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the bond angles between the supplied triplets of indices in each frame of a trajectory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory</p>
<blockquote>
<div><p>An mtraj trajectory.</p>
</div></blockquote>
<p><strong>angle_indices</strong> : np.ndarray, shape=(num_pairs, 2), dtype=int</p>
<blockquote>
<div><p>Each row gives the indices of three atoms which together make an angle.</p>
</div></blockquote>
<p><strong>opt</strong> : bool, default=True</p>
<blockquote>
<div><p>Use an optimized native library to calculate distances. Using this
library requires the python package &#8220;cffi&#8221; (c foreign function
interface) which is installable via &#8220;easy_install cffi&#8221; or &#8220;pip
install cffi&#8221;. See <a class="reference external" href="https://pypi.python.org/pypi/cffi">https://pypi.python.org/pypi/cffi</a> for more details.
Our optimized angle calculation implementation is 10-20x faster than
the (itself optimized) numpy implementation, so installing cffi is
generally worth it.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>angles</strong> : np.ndarray, shape=[n_frames, n_angles], dtype=float</p>
<blockquote class="last">
<div><p>The angles are in radians</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-mdtraj.geometry.dihedral">
<span id="dihedrals"></span><h2>Dihedrals<a class="headerlink" href="#module-mdtraj.geometry.dihedral" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="mdtraj.geometry.dihedral.compute_dihedrals">
<tt class="descclassname">mdtraj.geometry.dihedral.</tt><tt class="descname">compute_dihedrals</tt><big>(</big><em>traj</em>, <em>indices</em>, <em>opt=True</em><big>)</big><a class="reference internal" href="_modules/mdtraj/geometry/dihedral.html#compute_dihedrals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mdtraj.geometry.dihedral.compute_dihedrals" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the dihedral angles between the supplied quartets of atoms in each frame in a trajectory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory</p>
<blockquote>
<div><p>An mtraj trajectory.</p>
</div></blockquote>
<p><strong>indices</strong> : np.ndarray, shape=(num_dihedrals, 4), dtype=int</p>
<blockquote>
<div><p>Each row gives the indices of four atoms which together make a
dihedral angle. The angle is between the planes spanned by the first
three atoms and the last three atoms, a torsion around the bond
between the middle two atoms.</p>
</div></blockquote>
<p><strong>opt</strong> : bool, default=True</p>
<blockquote>
<div><p>Use an optimized native library to calculate distances. Using this
library requires the python package &#8220;cffi&#8221; (c foreign function
interface) which is installable via &#8220;easy_install cffi&#8221; or &#8220;pip
install cffi&#8221;. See <a class="reference external" href="https://pypi.python.org/pypi/cffi">https://pypi.python.org/pypi/cffi</a> for more details.
The optimized dihedral calculation is ~10-20x faster than the numpy
implementation, so installing cffi is generally worth it.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>dih</strong> : np.ndarray, shape=(num_dihedrals), dtype=float</p>
<blockquote class="last">
<div><p>dih[i,j] gives the dihedral angle at traj[i] correponding to indices[j].</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mdtraj.geometry.dihedral.atom_sequence_finder">
<tt class="descclassname">mdtraj.geometry.dihedral.</tt><tt class="descname">atom_sequence_finder</tt><big>(</big><em>traj</em>, <em>atom_names</em>, <em>rid_offsets=None</em>, <em>chain_id=0</em><big>)</big><a class="reference internal" href="_modules/mdtraj/geometry/dihedral.html#atom_sequence_finder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mdtraj.geometry.dihedral.atom_sequence_finder" title="Permalink to this definition">¶</a></dt>
<dd><p>Find sequences of atom indices correponding to desired atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory</p>
<blockquote>
<div><p>Trajectory for which you want dihedrals.</p>
</div></blockquote>
<p><strong>atom_names</strong> : np.ndarray, shape=(4), dtype=&#8217;str&#8217;</p>
<blockquote>
<div><p>Array of atoms to in each dihedral angle.</p>
</div></blockquote>
<p><strong>rid_offsets</strong> : np.ndarray, optional, shape=(4), dtype=&#8217;int&#8217;</p>
<blockquote>
<div><p>Array of integer offsets for each atom.</p>
</div></blockquote>
<p><strong>chain_id</strong> : int</p>
<blockquote class="last">
<div><p>The index of the chain to sequence.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>In additional finding dihedral atoms, this function could be used to
match <em>general</em> sequences of atoms and residue_id offsets.</p>
<p class="rubric">Examples</p>
<p>Here we calculate the phi torsion angles by specifying the correct
atom names and the residue_id offsets (e.g. forward or backward in
chain) for each atom.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">mdtraj</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;native.pdb&quot;</span><span class="p">)</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_names</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;C&quot;</span> <span class="p">,</span><span class="s">&quot;N&quot;</span> <span class="p">,</span> <span class="s">&quot;CA&quot;</span><span class="p">,</span> <span class="s">&quot;C&quot;</span><span class="p">]</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">rid_offsets</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">found_residue_ids</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="n">atom_sequence_finder</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">atom_names</span><span class="p">,</span> <span class="n">rid_offsets</span><span class="p">)</span> 
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mdtraj.geometry.dihedral.compute_phi">
<tt class="descclassname">mdtraj.geometry.dihedral.</tt><tt class="descname">compute_phi</tt><big>(</big><em>traj</em><big>)</big><a class="reference internal" href="_modules/mdtraj/geometry/dihedral.html#compute_phi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mdtraj.geometry.dihedral.compute_phi" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the phi torsions of a trajectory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory</p>
<blockquote>
<div><p>Trajectory for which you want dihedrals.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>rid</strong> : np.ndarray, shape=(n_phi, 4)</p>
<blockquote>
<div><p>The indices of the atoms involved in each of the
phi dihedral angles</p>
</div></blockquote>
<p><strong>angles</strong> : np.ndarray, shape=(n_frames, n_phi)</p>
<blockquote class="last">
<div><p>The value of the dihedral angle for each of the angles in each of
the frames.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mdtraj.geometry.dihedral.compute_psi">
<tt class="descclassname">mdtraj.geometry.dihedral.</tt><tt class="descname">compute_psi</tt><big>(</big><em>traj</em><big>)</big><a class="reference internal" href="_modules/mdtraj/geometry/dihedral.html#compute_psi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mdtraj.geometry.dihedral.compute_psi" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the psi torsions of a trajectory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory</p>
<blockquote>
<div><p>Trajectory for which you want dihedrals.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>rid</strong> : np.ndarray, shape=(n_psi, 4)</p>
<blockquote>
<div><p>The indices of the atoms involved in each of the
psi dihedral angles</p>
</div></blockquote>
<p><strong>angles</strong> : np.ndarray, shape=(n_frames, n_psi)</p>
<blockquote class="last">
<div><p>The value of the dihedral angle for each of the angles in each of
the frames.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mdtraj.geometry.dihedral.compute_omega">
<tt class="descclassname">mdtraj.geometry.dihedral.</tt><tt class="descname">compute_omega</tt><big>(</big><em>traj</em><big>)</big><a class="reference internal" href="_modules/mdtraj/geometry/dihedral.html#compute_omega"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mdtraj.geometry.dihedral.compute_omega" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the omega torsions of a trajectory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory</p>
<blockquote>
<div><p>Trajectory for which you want dihedrals.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>rid</strong> : np.ndarray, shape=(n_omega, 4)</p>
<blockquote>
<div><p>The indices of the atoms involved in each of the
omega dihedral angles</p>
</div></blockquote>
<p><strong>angles</strong> : np.ndarray, shape=(n_frames, n_omega)</p>
<blockquote class="last">
<div><p>The value of the dihedral angle for each of the angles in each of
the frames.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-mdtraj.geometry.rg">
<span id="radius-of-gyration"></span><h2>Radius of gyration<a class="headerlink" href="#module-mdtraj.geometry.rg" title="Permalink to this headline">¶</a></h2>
<p>Pure python code to calculate the radius of gyration of frames in a
trajectory</p>
<dl class="function">
<dt id="mdtraj.geometry.rg.compute_rg">
<tt class="descclassname">mdtraj.geometry.rg.</tt><tt class="descname">compute_rg</tt><big>(</big><em>traj</em>, <em>masses=None</em><big>)</big><a class="reference internal" href="_modules/mdtraj/geometry/rg.html#compute_rg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mdtraj.geometry.rg.compute_rg" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Rg for every frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory</p>
<p><strong>masses</strong> : ndarray, optional</p>
<blockquote>
<div><p>array of atom masses.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>Rg</strong> : ndarray</p>
<blockquote class="last">
<div><p>Rg for every frame</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If masses are none, assumes equal masses.</p>
</dd></dl>

</div>
<div class="section" id="alignment">
<h2>Alignment<a class="headerlink" href="#alignment" title="Permalink to this headline">¶</a></h2>
<p>Note: this code is not an interface to the IRMSD fast SSE2/SSE3
<a class="reference internal" href="rmsd.html#rmsd"><em>RMSD library</em></a>. This code provides more flexibility, at
the cost of some speed (IRMSD can only compute distances).</p>
<span class="target" id="module-mdtraj.geometry.alignment"></span><p>Here, we have implemented RMSD calculation using both Kabsch algorithm and
via the quaterion-based characteristic polynomial.  Both are implemented
in pure python/numpy.</p>
<div class="section" id="notes">
<h3>Notes<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h3>
<p>This module works at a frame-by-frame level, not the trajectory level.</p>
</div>
<div class="section" id="reference">
<h3>Reference<a class="headerlink" href="#reference" title="Permalink to this headline">¶</a></h3>
<p>Rapid calculation of RMSDs using a quaternion-based characteristic polynomial.
Acta Crystallogr A 61(4):478-480.</p>
<dl class="class">
<dt id="mdtraj.geometry.alignment.Transformation">
<em class="property">class </em><tt class="descclassname">mdtraj.geometry.alignment.</tt><tt class="descname">Transformation</tt><big>(</big><em>rotation</em>, <em>translation</em><big>)</big><a class="reference internal" href="_modules/mdtraj/geometry/alignment.html#Transformation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mdtraj.geometry.alignment.Transformation" title="Permalink to this definition">¶</a></dt>
<dd><p>Operator capable of rotating and translating a conformation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>rotation</strong> : np.array, shape=(3,3)</p>
<blockquote>
<div><p>Rotation matrix</p>
</div></blockquote>
<p><strong>rotation</strong> : np.array, shape=(3)</p>
<blockquote class="last">
<div><p>Translation vector</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="mdtraj-docs/docs/geometry.html#mdtraj.geometry.alignment.Transformation.transform" title="mdtraj.geometry.alignment.Transformation.transform"><tt class="xref py py-obj docutils literal"><span class="pre">transform</span></tt></a>(coordinates)</td>
<td>Apply an affine transformation to a set of coordinates.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="mdtraj.geometry.alignment.Transformation.transform">
<tt class="descname">transform</tt><big>(</big><em>coordinates</em><big>)</big><a class="reference internal" href="_modules/mdtraj/geometry/alignment.html#Transformation.transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mdtraj.geometry.alignment.Transformation.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply an affine transformation to a set of coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>coordinates</strong> : ndarray, shape = (n_atoms, 3)</p>
<blockquote>
<div><p>xyz coordinates of a <cite>single</cite> frame.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>mapped_coordinates</strong> : ndarray, shape = (n_atoms, 3)</p>
<blockquote class="last">
<div><p>xyz coordinates after being rotated and translated</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="mdtraj.geometry.alignment.compute_transformation">
<tt class="descclassname">mdtraj.geometry.alignment.</tt><tt class="descname">compute_transformation</tt><big>(</big><em>mobile</em>, <em>target</em><big>)</big><a class="reference internal" href="_modules/mdtraj/geometry/alignment.html#compute_transformation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mdtraj.geometry.alignment.compute_transformation" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Transformation object to align mobile onto target.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>mobile</strong> : ndarray, shape = (n_atoms, 3)</p>
<blockquote>
<div><p>xyz coordinates of a <cite>single</cite> frame, to be aligned onto target.</p>
</div></blockquote>
<p><strong>target</strong> : ndarray, shape = (n_atoms, 3)</p>
<blockquote>
<div><p>xyz coordinates of a <cite>single</cite> frame</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first last"><strong>T</strong> : Transformation aligning mobile to target.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mdtraj.geometry.alignment.transform">
<tt class="descclassname">mdtraj.geometry.alignment.</tt><tt class="descname">transform</tt><big>(</big><em>mobile</em>, <em>target</em><big>)</big><a class="reference internal" href="_modules/mdtraj/geometry/alignment.html#transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mdtraj.geometry.alignment.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Align mobile onto target and return transformed coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>mobile</strong> : ndarray, shape = (n_atoms, 3)</p>
<blockquote>
<div><p>xyz coordinates of a <cite>single</cite> frame, to be aligned onto target.</p>
</div></blockquote>
<p><strong>target</strong> : ndarray, shape = (n_atoms, 3)</p>
<blockquote>
<div><p>xyz coordinates of a <cite>single</cite> frame</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>mobile_prime</strong> : ndarray, shape = (n_atoms, 3)</p>
<blockquote class="last">
<div><p>Transformed coordinates of mobile, optimally aligned to target.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mdtraj.geometry.alignment.compute_translation_and_rotation">
<tt class="descclassname">mdtraj.geometry.alignment.</tt><tt class="descname">compute_translation_and_rotation</tt><big>(</big><em>mobile</em>, <em>target</em><big>)</big><a class="reference internal" href="_modules/mdtraj/geometry/alignment.html#compute_translation_and_rotation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mdtraj.geometry.alignment.compute_translation_and_rotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the translation and rotation mapping mobile onto target.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>mobile</strong> : ndarray, shape = (n_atoms, 3)</p>
<blockquote>
<div><p>xyz coordinates of a <cite>single</cite> frame, to be aligned onto target.</p>
</div></blockquote>
<p><strong>target</strong> : ndarray, shape = (n_atoms, 3)</p>
<blockquote>
<div><p>xyz coordinates of a <cite>single</cite> frame</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>translation</strong> : ndarray, shape=(3,)</p>
<blockquote>
<div><p>Difference between the centroids of the two conformations</p>
</div></blockquote>
<p><strong>rotation</strong> : ndarray, shape=(3,3)</p>
<blockquote class="last">
<div><p>Rotation matrix to apply to mobile to carry out the transformation.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mdtraj.geometry.alignment.rmsd_kabsch">
<tt class="descclassname">mdtraj.geometry.alignment.</tt><tt class="descname">rmsd_kabsch</tt><big>(</big><em>xyz1</em>, <em>xyz2</em><big>)</big><a class="reference internal" href="_modules/mdtraj/geometry/alignment.html#rmsd_kabsch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mdtraj.geometry.alignment.rmsd_kabsch" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the RMSD distance between conformations xyz1 and xyz2.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>xyz1</strong> : ndarray, shape = (n_atoms, 3)</p>
<blockquote>
<div><p>xyz1 coordinates of a SINGLE frame</p>
</div></blockquote>
<p><strong>xyz2</strong> : ndarray, shape = (n_atoms, 3)</p>
<blockquote>
<div><p>xyz2 coordinates of a SINGLE frame</p>
</div></blockquote>
<p><strong>Returns</strong> :</p>
<p><strong>&#8212;&#8212;-</strong> :</p>
<p><strong>rmsd</strong> : float</p>
<blockquote class="last">
<div><p>RMSD between xyz1 and xyz2</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mdtraj.geometry.alignment.rmsd_qcp">
<tt class="descclassname">mdtraj.geometry.alignment.</tt><tt class="descname">rmsd_qcp</tt><big>(</big><em>conformation1</em>, <em>conformation2</em><big>)</big><a class="reference internal" href="_modules/mdtraj/geometry/alignment.html#rmsd_qcp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mdtraj.geometry.alignment.rmsd_qcp" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the RMSD with Theobald&#8217;s quaterion-based characteristic
polynomial</p>
<p>Rapid calculation of RMSDs using a quaternion-based characteristic polynomial.
Acta Crystallogr A 61(4):478-480.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>conformation1</strong> : np.ndarray, shape=(n_atoms, 3)</p>
<blockquote>
<div><p>The cartesian coordinates of the first conformation</p>
</div></blockquote>
<p><strong>conformation2</strong> : np.ndarray, shape=(n_atoms, 3)</p>
<blockquote>
<div><p>The cartesian coordinates of the second conformation</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>rmsd</strong> : float</p>
<blockquote class="last">
<div><p>The root-mean square deviation after alignment between the two pointsets</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="hydrogen-bonds">
<h2>Hydrogen Bonds<a class="headerlink" href="#hydrogen-bonds" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="mdtraj.geometry.kabsch_sander">
<tt class="descclassname">mdtraj.geometry.</tt><tt class="descname">kabsch_sander</tt><big>(</big><em>traj</em><big>)</big><a class="headerlink" href="#mdtraj.geometry.kabsch_sander" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Kabsch-Sander hydrogen bond energy between each pair
of residues in every frame.</p>
<p>Hydrogen bonds are defined using an electrostatic definition, assuming
partial charges of -0.42 e and +0.20 e to the carbonyl oxygen and amide
hydrogen respectively, their opposites assigned to the carbonyl carbon
and amide nitrogen. A hydrogen bond is identified if E in the following
equation is less than -0.5 kcal/mol:</p>
<div class="math">
\[E = 0.42 \cdot 0.2 \cdot 33.2 kcal/(mol \cdot nm) * \
    (1/r_{ON} + 1/r_{CH} - 1/r_{OH} - 1/r_{CN})\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>traj</strong> : md.Trajectory</p>
<blockquote>
<div><p>An mdtraj trajectory. It must contain topology information.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>matrices</strong> : list of scipy.sparse.csr_matrix</p>
<blockquote class="last">
<div><p>The return value is a list of length equal to the number of frames
in the trajectory. Each element is an n_residues x n_residues sparse
matrix, where the existance of an entry at row <cite>i</cite>, column <cite>j</cite> with value
<cite>x</cite> means that there exists a hydrogen bond between a backbone CO
group at residue <cite>i</cite> with a backbone NH group at residue <cite>j</cite> whose
Kabsch-Sander energy is less than -0.5 kcal/mol (the threshold for
existance of the &#8220;bond&#8221;). The exact value of the energy is given by the
value <cite>x</cite>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[R1]</a></td><td>Kabsch W, Sander C (1983). &#8220;Dictionary of protein secondary structure: pattern recognition of hydrogen-bonded and geometrical features&#8221;. Biopolymers 22 (12): 2577-637. dio:10.1002/bip.360221211</td></tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="solvent-accessible-surface-area">
<h2>Solvent Accessible Surface Area<a class="headerlink" href="#solvent-accessible-surface-area" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="mdtraj.geometry.shrake_rupley">
<tt class="descclassname">mdtraj.geometry.</tt><tt class="descname">shrake_rupley</tt><big>(</big><em>traj</em>, <em>probe_radius=0.14</em>, <em>n_sphere_points=960</em><big>)</big><a class="headerlink" href="#mdtraj.geometry.shrake_rupley" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the solvent accessible surface area of each atom in each simulation frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory</p>
<blockquote>
<div><p>An mtraj trajectory.</p>
</div></blockquote>
<p><strong>probe_radius</strong> : float, optional</p>
<blockquote>
<div><p>The radius of the probe, in nm.</p>
</div></blockquote>
<p><strong>n_sphere_pts</strong> : int, optional</p>
<blockquote>
<div><p>The number of points representing the surface of each atom, higher
values leads to more accuracy.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>areas</strong> : np.array, shape=(n_frames, n_atoms)</p>
<blockquote class="last">
<div><p>The accessible surface area of each atom in every frame</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This code implements the Shrake and Rupley algorithm, with the Golden
Section Spiral algorithm to generate the sphere points. The basic idea
is to great a mesh of points representing the surface of each atom
(at a distance of the van der waals radius plus the probe
radius from the nuclei), and then count the number of such mesh points
that are on the molecular surface &#8211; i.e. not within the radius of another
atom. Assuming that the points are evenly distributed, the number of points
is directly proportional to the accessible surface area (its just 4*pi*r^2
time the fraction of the points that are accessible).</p>
<p>There are a number of different ways to generate the points on the sphere &#8211;
possibly the best way would be to do a little &#8220;molecular dyanmics&#8221; : put the
points on the sphere, and then run MD where all the points repel one another
and wait for them to get to an energy minimum. But that sounds expensive.</p>
<p>This code uses the golden section spiral algorithm
(picture at <a class="reference external" href="http://xsisupport.com/2012/02/25/evenly-distributing-points-on-a-sphere-with-the-golden-sectionspiral/">http://xsisupport.com/2012/02/25/evenly-distributing-points-on-a-sphere-with-the-golden-sectionspiral/</a>)
where you make this spiral that traces out the unit sphere and then put points
down equidistant along the spiral. It&#8217;s cheap, but not perfect.</p>
<p>The gromacs utility g_sas uses a slightly different algorithm for generating
points on the sphere, which is based on an icosahedral tesselation.
roughly, the icosahedral tesselation works something like this
<a class="reference external" href="http://www.ziyan.info/2008/11/sphere-tessellation-using-icosahedron.html">http://www.ziyan.info/2008/11/sphere-tessellation-using-icosahedron.html</a></p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[R2]</a></td><td>Shrake, A; Rupley, JA. (1973) J Mol Biol 79 (2): 351&#8211;71.</td></tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<a href="index.html"><img src="_static/mdtraj_logo-small.png" alt="Logo"/></a>

  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Geometry : <tt class="docutils literal"><span class="pre">mdtraj.geometry</span></tt></a><ul>
<li><a class="reference internal" href="#distances">Distances</a></li>
<li><a class="reference internal" href="#angles">Angles</a></li>
<li><a class="reference internal" href="#module-mdtraj.geometry.dihedral">Dihedrals</a></li>
<li><a class="reference internal" href="#module-mdtraj.geometry.rg">Radius of gyration</a></li>
<li><a class="reference internal" href="#alignment">Alignment</a><ul>
<li><a class="reference internal" href="#notes">Notes</a></li>
<li><a class="reference internal" href="#reference">Reference</a></li>
</ul>
</li>
<li><a class="reference internal" href="#hydrogen-bonds">Hydrogen Bonds</a></li>
<li><a class="reference internal" href="#solvent-accessible-surface-area">Solvent Accessible Surface Area</a></li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/geometry.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="compatibility.html" title="MSMBuilder2 Compatibility (.lh5)"
             >next</a> |</li>
        <li class="right" >
          <a href="io.html" title="Generic (Compressed) Array IO : mdtraj.io"
             >previous</a> |</li>
        <li><a href="index.html">MDTraj 0.4.1 documentation</a> |</li>
<a href="getting_started.html">Getting Started</a> |
<a href="https://github.com/rmcgibbo/mdtraj/issues">Bugs</a> |
<a href="examples/index.html">Examples</a> |
<a href="mdconvert.html"><span class="pre">mdconvert</span></a>
 

      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2013, Robert McGibbon and contributors.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-42143125-1', 'rmcgibbo.github.io');
  ga('send', 'pageview');
</script>

  </body>
</html>